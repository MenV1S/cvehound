/// Files: net/bluetooth/hci_core.c
/// Fixes: 6a137caec23aeb9e036cdfd8a46dd8a366460e5d

virtual detect

@err exists@
identifier hdev;
position p_rx_flush;
position p_cmd_flush;
@@



static int hci_dev_do_open(struct hci_dev *hdev)
{
	...
	flush_work@p_cmd_flush(&hdev->cmd_work);
	flush_work@p_rx_flush(&hdev->rx_work);
	...
}


@script:python depends on detect@
p << err.p_cmd_flush;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-3564')
